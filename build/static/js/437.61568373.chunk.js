"use strict";(self.webpackChunkrich_penny_frontend=self.webpackChunkrich_penny_frontend||[]).push([[437],{4437:(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var n=a(2389),r=a(6359),o=a(9860),l=a(2832),i=a(1806),s=a(8485),d=a(5280),c=a(7313),u=a(9620),x=a(3875),h=a(2030),p=a(5531),m=a(4014),v=a(5662),g=a(56);const b=e=>(0,g.useQuery)(["get_investment_data",e],(()=>(0,v.Z)({method:"GET",url:"/get_investment_data/",params:e})));var f=a(2703),w=a(3223),_=a(9601),y=a(5765),j=a(6417);const C=["Daily","Monthly"],k=()=>{var e,t,a,r,i,s;const d=(0,o.Z)(),{showSnackbar:u,hideSnackbar:k}=(0,p.Ds)(),[P,Z]=(0,c.useState)(""),[D,H]=(0,c.useState)("Daily"),[T,A]=(0,c.useState)(null),G=(0,g.useQuery)(["get_transaction_fees"],(()=>(0,v.Z)({method:"GET",url:"/get_transaction_fees/1/"}))),S=(0,g.useMutation)((e=>(0,v.Z)({method:"Put",url:"/update_transaction_fees/1/",data:e.request}))),K=b({data_type:D.toLowerCase()}),M=null!==(e=null===(t=K.data)||void 0===t?void 0:t.data.data.transaction_data)&&void 0!==e?e:[],E=[{field:"date",renderHeader:()=>"Daily"===D?"Date":"Month",renderCell:e=>{let{row:t}=e;return t.date},tableCellProps:{sx:{width:120}},tableHeaderProps:{sx:{width:120}}},{field:"total_transaction",renderHeader:()=>"Total Transaction (\u20b9)",renderCell:e=>{let{row:t}=e;return t.total_transaction},tableCellProps:{sx:{width:250,textAlign:"center"}},tableHeaderProps:{sx:{width:250,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"total_gst",renderHeader:()=>"Total GST",renderCell:e=>{let{row:t}=e;return t.total_gst},tableCellProps:{sx:{width:200,textAlign:"center"}},tableHeaderProps:{sx:{width:200,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"total_investment",renderHeader:()=>"Total Investment (\u20b9)",renderCell:e=>{let{row:t}=e;return t.total_investment},tableCellProps:{sx:{width:200,textAlign:"center"}},tableHeaderProps:{sx:{width:200,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"total_commission",renderHeader:()=>"Total Comission",renderCell:e=>{let{row:t}=e;return t.total_commission},tableCellProps:{sx:{width:210,textAlign:"center"}},tableHeaderProps:{sx:{width:210,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"gst_commission",renderHeader:()=>"GST on Commision",renderCell:e=>{let{row:t}=e;return t.gst_commission},tableCellProps:{sx:{width:200,textAlign:"center"}},tableHeaderProps:{sx:{width:200,flexDirection:"column",textAlign:"-webkit-center"}}}];return(0,c.useEffect)((()=>{var e,t,a;Z(null!==(e=null===(t=G.data)||void 0===t||null===(a=t.data.response_data)||void 0===a?void 0:a.transaction_fees)&&void 0!==e?e:"")}),[G.dataUpdatedAt]),(0,j.jsxs)(l.Z,{gap:2,flexGrow:"inherit",children:[(0,j.jsxs)(l.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",children:[(0,j.jsxs)(l.Z,{flexDirection:"row",gap:2,alignItems:"flex-end",children:[(0,j.jsx)(h.Z,{fieldName:"input",fieldProps:{label:"Transaction Fee",fullWidth:!0,sx:{width:465,gap:0},disabled:null===(a=G.data)||void 0===a||null===(r=a.data.response_data)||void 0===r?void 0:r.clickable},onChange:(e,t)=>Z(t),value:P}),(0,j.jsx)(f.Z,{variant:"contained",size:"large",sx:{height:40},loading:S.isLoading,disabled:null===(i=G.data)||void 0===i||null===(s=i.data.response_data)||void 0===s?void 0:s.clickable,children:(0,j.jsx)(n.KH,{variant:"caption",onClick:()=>{S.mutateAsync({request:{transaction_fee:P}}).then((e=>{var t;u({title:"Success!",variant:"sucess",content:null===(t=e.data)||void 0===t?void 0:t.message,onCancel:()=>k()}),K.refetch(),G.refetch()})).catch((e=>{var t,a;u({title:"Error!",variant:"error",content:null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message,onCancel:()=>k()})}))},children:"Submit"})})]}),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(w.Z,{variant:"outlined",size:"large",sx:{minWidth:180,borderColor:"#DFE3ED",justifyContent:"space-between"},onClick:e=>A(e.currentTarget),endIcon:(0,j.jsx)(x.Z,{iconName:"ChevronDown",iconProps:{fill:d.palette.common.primaryGreyText}}),children:(0,j.jsx)(n.KH,{variant:"subtitle2",sx:{color:d.palette.common.primaryGreyText},children:D})}),(0,j.jsx)(_.Z,{anchorEl:T,open:Boolean(T),onClose:()=>A(null),sx:{".MuiMenu-paper":{left:"auto !important",right:"".concat(d.spacing(3)," !important"),width:null===T||void 0===T?void 0:T.offsetWidth}},children:C.map((e=>(0,j.jsx)(y.Z,{onClick:()=>{H(e),A(null)},children:e},e)))})]})]}),(0,j.jsx)(m.Z,{rows:M,columns:E,rowId:e=>e.id,tableProps:{size:"small",stickyHeader:!1},tableRowProps:{hover:!0},loading:K.isLoading,sx:{paddingTop:5}})]})},P=(0,c.memo)(k);var Z=a(7154),D=a(2368),H=a(816),T=a.n(H);const A=()=>{var e,t,a,r;const s=(0,o.Z)(),{showAlertDialog:d,hideAlertDialog:u}=(0,Z.ij)(),{showSnackbar:b,hideSnackbar:f}=(0,p.Ds)(),_=(0,g.useQuery)(["get_profit_for_month/3/"],(()=>(0,v.Z)({method:"GET",url:"/get_profit_for_month/3/"}))),y=(0,g.useMutation)((e=>(0,v.Z)({method:"POST",url:"/add_profit_for_month/",data:e.request}))),C=(0,g.useQuery)(["get_monthly_payback_data"],(()=>(0,v.Z)({method:"GET",url:"/get_monthly_payback_data/"}))),[k,P]=(0,c.useState)(""),H=new Date((new Date).setMonth((new Date).getMonth()-1)),A=T()(H.toDateString()).format("MMMM");console.warn(A);const G=null!==(e=null===(t=C.data)||void 0===t?void 0:t.data.data.payback_data)&&void 0!==e?e:[],S=[{field:"month_year",renderHeader:()=>"Month",renderCell:e=>{let{row:t}=e;return t.month_year},tableCellProps:{sx:{width:200}},tableCellTypographySx:{paddingLeft:s.spacing(1)},tableHeaderProps:{sx:{width:200}}},{field:"total_disbursable_amount",renderHeader:()=>"Total Disbursable Amount (\u20b9)",renderCell:e=>{let{row:t}=e;return t.total_disbursable_amount},tableCellProps:{sx:{width:350,textAlign:"center"}},tableHeaderProps:{sx:{width:350,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"payback_to_user",renderHeader:()=>"Payback Disbursed to User",renderCell:e=>{let{row:t}=e;return t.payback_to_user},tableCellProps:{sx:{width:350,textAlign:"center"}},tableHeaderProps:{sx:{width:350,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"payback_to_restaurant",renderHeader:()=>"Payback Disbursed to Restaurant (\u20b9)",renderCell:e=>{let{row:t}=e;return t.payback_to_restaurant},tableCellProps:{sx:{width:400,textAlign:"center"}},tableHeaderProps:{sx:{width:400,flexDirection:"column",textAlign:"-webkit-center"}}}];return(0,c.useEffect)((()=>{var e,t,a;P(null!==(e=null===(t=_.data)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.profit_for_month)&&void 0!==e?e:"")}),[_.dataUpdatedAt]),(0,j.jsxs)(l.Z,{gap:2,flexGrow:"inherit",children:[(0,j.jsxs)(l.Z,{flexDirection:"row",gap:2,alignItems:"flex-end",children:[(0,j.jsx)(h.Z,{fieldName:"input",fieldProps:{label:"Profit for Month",fullWidth:!0,sx:{width:465,gap:0},disabled:null===(a=_.data)||void 0===a?void 0:a.data.clickable},onChange:(e,t)=>P(t),value:k}),(0,j.jsx)(w.Z,{variant:"contained",size:"large",sx:{height:40},onClick:()=>{d({title:(0,j.jsxs)(l.Z,{flexDirection:"row",gap:3,children:[(0,j.jsx)(x.Z,{iconName:"Warning",iconProps:{style:{marginTop:"8px"}}}),(0,j.jsxs)(l.Z,{children:[(0,j.jsx)(n.KH,{variant:"h4",sx:{color:s.palette.common.primaryGreyText},children:"Profit Amount Confirmation"}),(0,j.jsx)(n.KH,{variant:"subtitle1",sx:{color:"#929292"},children:"Your are entering the the profit amount. Make sure you have entered correct amount."})]})]}),content:(0,j.jsx)(i.Z,{gap:2,sx:{textAlign:"-webkit-center","& table":{borderCollapse:"separate",borderSpacing:"0 4px"},"& .tdValue":{paddingLeft:4},"& tr":{verticalAlign:"top"}},children:(0,j.jsx)(D.Z,{data:[{name:(0,j.jsxs)(l.Z,{flexDirection:"row",justifyContent:"space-between",children:[(0,j.jsx)(n.KH,{variant:"h6",paddingRight:4,sx:{color:s.palette.common.primaryGreyText},fontWeight:400,children:"Profit Amount (\u20b9)"}),(0,j.jsx)(n.KH,{variant:"subtitle1",sx:{color:s.palette.common.secondaryGreyText},children:":"})]}),value:(0,j.jsx)(n.KH,{variant:"h6",paddingRight:4,sx:{color:s.palette.common.primaryGreyText},fontWeight:600,children:k}),showWhen:!0},{name:(0,j.jsxs)(l.Z,{flexDirection:"row",justifyContent:"space-between",gap:2,children:[(0,j.jsx)(n.KH,{variant:"h6",sx:{color:s.palette.common.primaryGreyText},fontWeight:400,children:A}),(0,j.jsx)(n.KH,{variant:"subtitle1",sx:{color:s.palette.common.secondaryGreyText},children:":"})]}),value:(0,j.jsx)(n.KH,{variant:"h6",sx:{color:s.palette.common.primaryGreyText},fontWeight:600}),showWhen:!0}]})}),buttons:[{children:"Cancel",variant:"outlined",callback:()=>{u()}},{children:"Confirm",variant:"contained",callback:()=>{y.mutateAsync({request:{profit_for_month:k}}).then((e=>{var t;b({title:"Success!",variant:"sucess",content:null===(t=e.data)||void 0===t?void 0:t.message,onCancel:()=>f()}),u(),_.refetch(),C.refetch()})).catch((e=>{var t,a;b({title:"Error!",variant:"error",content:null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message,onCancel:()=>f()})}))}}]})},disabled:null===(r=_.data)||void 0===r?void 0:r.data.clickable,children:(0,j.jsx)(n.KH,{variant:"caption",children:"Submit"})})]}),(0,j.jsx)(m.Z,{rows:G,columns:S,rowId:e=>e.id,tableProps:{size:"small",stickyHeader:!1},tableRowProps:{hover:!0},loading:C.isLoading,sx:{paddingTop:5}})]})},G=(0,c.memo)(A),S=["INVESTMENT","PAYBACK"],K=()=>{var e,t,a,x;const h=(0,o.Z)();(0,r.Q)(r.D.investment);const p=b(),[m,v]=(0,c.useState)(0);return(0,j.jsxs)(l.Z,{gap:2,flexGrow:"inherit",children:[(0,j.jsxs)(l.Z,{gap:2,flexDirection:"row",children:[(0,j.jsx)(u.fK,{heading:"Total Investment",content:null===(e=p.data)||void 0===e?void 0:e.data.data.total_investment}),(0,j.jsx)(u.fK,{heading:"Total Payback Amount",content:null===(t=p.data)||void 0===t?void 0:t.data.data.total_payback_amount,sx:{width:250}}),(0,j.jsx)(u.fK,{heading:"Current Payback",content:null===(a=p.data)||void 0===a?void 0:a.data.data.current_payback}),(0,j.jsx)(u.fK,{heading:"Current Investment",content:null===(x=p.data)||void 0===x?void 0:x.data.data.current_investment})]}),(0,j.jsxs)(l.Z,{gap:2,flexGrow:1,children:[(0,j.jsx)(i.Z,{sx:{width:"100%",padding:"8px",backgroundColor:"#E9EBF0",borderRadius:"8px"},children:(0,j.jsx)(s.Z,{value:m,onChange:(e,t)=>{v(t)},children:S.map(((e,t)=>(0,j.jsx)(d.Z,{sx:{minWidth:"50%"},label:(0,j.jsx)(n.KH,{variant:"subtitle1",sx:{color:h.palette.common.primaryGreyText},children:e})},t)))})}),0===m&&(0,j.jsx)(P,{}),1===m&&(0,j.jsx)(G,{})]})]})},M=(0,c.memo)(K)}}]);