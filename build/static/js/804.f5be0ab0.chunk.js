"use strict";(self.webpackChunkrich_penny_frontend=self.webpackChunkrich_penny_frontend||[]).push([[804],{4812:(e,t,a)=>{a.d(t,{q:()=>x});var n=a(2832),o=a(9536),r=a(1685),i=a(1806),l=a(3875),s=(a(816),a(2389)),d=a(3208),c=a(7238),u=a(7426),h=a(9550),p=a(6417);const x=e=>{var t,a,x,m,g,y;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(n.Z,{flexDirection:"row",border:"1px solid #E5E5E5",borderRadius:"40px",alignItems:"center",height:24,children:[(0,p.jsx)(l.Z,{iconName:"ChevronRight",iconProps:{width:28,height:20,fill:"black",transform:"rotate(180 0 0)",onClick:e.onLeftClick,cursor:"pointer"}}),(0,p.jsx)(o.Z,{orientation:"vertical",sx:{borderColor:"#E5E5E5"}}),(0,p.jsxs)(n.Z,{gap:.5,flexDirection:"row",alignItems:"center",paddingX:1,onClick:e.onCalenderClick,sx:{cursor:"pointer"},children:[(0,p.jsx)(l.Z,{iconName:"Calender2"}),(0,p.jsx)(s.jb,{fontSize:"7px",children:null===(t=e.date)||void 0===t?void 0:t.get("year")})]}),(0,p.jsx)(o.Z,{orientation:"vertical",sx:{borderColor:"#E5E5E5"}}),(0,p.jsx)(l.Z,{iconName:"ChevronRight",iconProps:{width:28,height:20,fill:"black",onClick:e.onRightClick,cursor:"pointer"}})]}),e.show&&e.anchorEl&&(0,p.jsx)(r.d,{onClickAway:e.handleClose,children:(0,p.jsx)(i.Z,{zIndex:100,position:"fixed",top:"".concat((null!==(a=null===(x=e.anchorEl)||void 0===x?void 0:x.getBoundingClientRect().top)&&void 0!==a?a:0)+20,"px"),left:(null===(m=e.anchorEl)||void 0===m?void 0:m.getBoundingClientRect().left)-100-(null!==(g=e.position)&&void 0!==g&&g.left?null===(y=e.position)||void 0===y?void 0:y.left:0),boxShadow:"0px 2px 8px 0px #00000026",children:(0,p.jsx)(d._,{dateAdapter:u.Q,children:(0,p.jsx)(h.C,{components:["DatePicker"],sx:{flexDirection:"column-reverse !important",overflow:"hidden",padding:"inherit"},children:(0,p.jsx)(c.w,{value:e.date,views:["year"],onChange:e.onChange,sx:{"& .MuiPickersLayout-actionBar":{display:"none"}}})})})})})]})}},6286:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var n=a(2389),o=a(6359),r=a(9860),i=a(2832),l=a(6212),s=a(9536),d=a(7131),c=a(4469),u=a(3604),h=a(6467),p=a(3223),x=a(9601),m=a(5765),g=a(8446),y=a(7313),v=a(816),f=a.n(v),b=a(3875),w=a(2703),C=a(4812),D=a(3208),j=a(7238),M=a(7426),k=a(9550),S=a(5662),Z=a(56);var _=a(5531),R=a(8173),P=a(6417);const T=["Daily","Monthly","Quarterly"],I=["GST Return","Monthly TDS Return","Quarterly TDS Return","Customer Disbursement","Restaurant Disbursement","Discount Structure Savings","Vendor Payment","Restaurant Incentive","Monthly Restaurant transaction","Restaurant Membership Profit"],E=()=>{var e,t,a,c,u,h,p,x,m,v,w,D,j,M,k,_,E,Y,q,B,F;const W=(0,r.Z)();(0,o.Q)(o.D.reports);const[G,L]=(0,y.useState)(!1),[H,N]=(0,y.useState)(null),[Q,A]=(0,y.useState)({date:f()(),type:"Daily"}),[K,J]=(0,y.useState)({date:f()(),type:"Daily"}),V=(O={filter:K.type.toLowerCase(),calendar:"year",year:null===(e=K.date)||void 0===e?void 0:e.get("year").toString()},(0,Z.useQuery)(["investment_paybackgraph",O],(()=>(0,S.Z)({method:"GET",url:"/investment_paybackgraph/",params:O}))));var O;const X=(e=>(0,Z.useQuery)(["transaction_and_usergraph",e],(()=>(0,S.Z)({method:"GET",url:"/transaction_and_usergraph/",params:e}))))({filter:Q.type.toLowerCase(),calendar:"year",year:null===(t=Q.date)||void 0===t?void 0:t.get("year").toString(),month:null===(a=Q.date)||void 0===a?void 0:a.format("MMMM")});return(0,P.jsxs)(i.Z,{gap:5,paddingTop:6,paddingBottom:3,children:[(0,P.jsxs)(i.Z,{flexDirection:"row",gap:2,children:[(0,P.jsxs)(i.Z,{boxShadow:"0px 2px 8px 0px #00000026",padding:1.3,flexBasis:"60%",gap:2,children:[(0,P.jsxs)(i.Z,{flexDirection:"row",justifyContent:"space-between",children:[(0,P.jsx)(n.jb,{fontWeight:600,variant:"subtitle1",children:"Total Transaction/no. of users"}),(0,P.jsxs)(i.Z,{gap:1,flexDirection:"row",children:[T.filter((e=>"Monthly"===e||"Daily"===e)).map((e=>(0,P.jsx)(l.Z,{size:"small",label:e,sx:{fontSize:7,backgroundColor:Q.type===e?"#E7EBFE":"transparent"},onClick:()=>A({...Q,type:e})},e))),(0,P.jsx)(C.q,{onRightClick:()=>A({...Q,date:f()(Q.date).add(1,"year")}),onLeftClick:()=>A({...Q,date:f()(Q.date).subtract(1,"year")}),onCalenderClick:e=>N({element:e.currentTarget,box:1}),onChange:e=>{A({...Q,date:e}),N(null)},show:Boolean(H)&&1===(null===H||void 0===H?void 0:H.box),handleClose:()=>N(null),anchorEl:null===H||void 0===H?void 0:H.element,date:Q.date}),(0,P.jsx)(b.Z,{iconName:"MoreVertical",iconProps:{height:24,fill:"black"}})]})]}),(0,P.jsx)(g.Z,{options:{chart:{zoom:{enabled:!1}},dataLabels:{enabled:!1},xaxis:{categories:null!==(c=null===(u=X.data)||void 0===u||null===(h=u.data.data)||void 0===h?void 0:h.x_axis)&&void 0!==c?c:[]},yaxis:{labels:{formatter:e=>null===e||void 0===e?void 0:e.toFixed(0)},tickAmount:(0,R.x1)(null!==(p=null===(x=X.data)||void 0===x||null===(m=x.data.data)||void 0===m?void 0:m.y_axis)&&void 0!==p?p:[])},tooltip:{enabled:!0,followCursor:!0},colors:[W.palette.primary.main]},series:[{name:"Total Transaction/no. of users",data:null!==(v=null===(w=X.data)||void 0===w||null===(D=w.data.data)||void 0===D?void 0:D.y_axis)&&void 0!==v?v:[]}],type:"area",height:365})]}),(0,P.jsx)(i.Z,{boxShadow:"0px 2px 8px 0px #00000026",padding:1.3,flexBasis:"40%",children:(0,P.jsxs)(i.Z,{gap:2,children:[(0,P.jsxs)(i.Z,{justifyContent:"space-between",flexDirection:"row",children:[(0,P.jsx)(n.jb,{fontWeight:600,variant:"subtitle1",children:"Investment/payback"}),(0,P.jsx)(b.Z,{iconName:"MoreVertical",iconProps:{height:24,fill:"black"}})]}),(0,P.jsxs)(i.Z,{justifyContent:"space-between",flexDirection:"row",children:[(0,P.jsx)(i.Z,{gap:1,flexDirection:"row",children:T.map((e=>(0,P.jsx)(l.Z,{size:"medium",label:e,sx:{fontSize:10,height:27,backgroundColor:K.type===e?"#E7EBFE":"transparent"},onClick:()=>J({...K,type:e})},e)))}),(0,P.jsx)(C.q,{onRightClick:()=>J({...K,date:f()(K.date).add(1,"year")}),onLeftClick:()=>J({...K,date:f()(K.date).subtract(1,"year")}),onCalenderClick:e=>N({element:e.currentTarget,box:2}),onChange:e=>{J({...K,date:e}),N(null)},show:Boolean(H)&&2===(null===H||void 0===H?void 0:H.box),handleClose:()=>N(null),anchorEl:null===H||void 0===H?void 0:H.element,date:K.date,position:{left:100}})]}),(0,P.jsx)(g.Z,{options:{chart:{zoom:{enabled:!1}},dataLabels:{enabled:!1},xaxis:{categories:null!==(j=null===(M=V.data)||void 0===M||null===(k=M.data.data)||void 0===k?void 0:k.x_axis)&&void 0!==j?j:[]},yaxis:{labels:{formatter:e=>null===e||void 0===e?void 0:e.toFixed(0)},tickAmount:(0,R.x1)(null!==(_=null===(E=V.data)||void 0===E||null===(Y=E.data.data)||void 0===Y?void 0:Y.y_axis)&&void 0!==_?_:[])},tooltip:{enabled:!0,followCursor:!0},colors:[W.palette.primary.main]},series:[{name:"Investment/payback",data:null!==(q=null===(B=V.data)||void 0===B||null===(F=B.data.data)||void 0===F?void 0:F.y_axis)&&void 0!==q?q:[]}],type:"bar",height:321})]})})]}),(0,P.jsxs)(i.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[(0,P.jsx)(n.KH,{variant:"subtitle1",sx:{color:W.palette.common.primaryGreyText},children:"Download Reports"}),(0,P.jsx)(s.Z,{orientation:"horizontal"}),(0,P.jsx)(b.Z,{iconName:"ChevronDown",iconProps:{fill:"black"}})]}),(0,P.jsx)(i.Z,{flexDirection:"row",flexWrap:"wrap",gap:1,children:I.map((e=>{return(0,P.jsxs)(i.Z,{height:64,border:"1px solid #C1C0CB",borderRadius:"6px",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingX:"23px",flexBasis:"33%",children:[(0,P.jsx)(n.KH,{variant:"subtitle1",sx:{color:W.palette.common.primaryGreyText},children:e}),(0,P.jsx)(d.Z,{size:"small",onClick:(t=e,()=>{L(t)}),children:(0,P.jsx)(b.Z,{iconName:"Download"})})]},e);var t}))}),G&&(0,P.jsx)(z,{handleClose:()=>L(!1),heading:G})]})},Y=(0,y.memo)(E),z=e=>{const t=(0,r.Z)(),{showSnackbar:a,hideSnackbar:o}=(0,_.Ds)(),l=Array.from({length:3},((e,t)=>"".concat((new Date).getFullYear()-t-1,"-").concat((new Date).getFullYear()-t))).reverse(),s=(new Date).getMonth()+1<=3?"".concat((new Date).getFullYear()-1,"-").concat((new Date).getFullYear()):"".concat((new Date).getFullYear(),"-").concat((new Date).getFullYear()+1),[d,g]=(0,y.useState)(null),[C,R]=(0,y.useState)(s),T=[...l,s],I=(0,Z.useMutation)((e=>(0,S.Z)({method:"POST",url:"/".concat(e.url,"/"),params:e.request}))),[E,Y]=(0,y.useState)(""),[z,q]=(0,y.useState)(f()()),[B,F]=(0,y.useState)("04"),[W,G]=(0,y.useState)(null),[L,H]=(0,y.useState)("");let N;const Q={1:(0,v.months)().splice(3,3),2:(0,v.months)().splice(6,3),3:(0,v.months)().splice(9,3),4:(0,v.months)().splice(0,3)};return(0,P.jsxs)(c.Z,{onClose:e.handleClose,open:Boolean(e.heading),sx:{".MuiPaper-root":{width:"100%",minWidth:752}},children:[(0,P.jsx)(u.Z,{sx:{padding:4,paddingBottom:3},children:(0,P.jsx)(n.KH,{variant:"h6",fontWeight:600,sx:{color:t.palette.common.primaryGreyText},children:e.heading})}),(0,P.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",gap:6,padding:4},children:[(0,P.jsx)(i.Z,{flexDirection:"row",children:(0,P.jsxs)(n.KH,{fontSize:18,sx:{color:t.palette.common.primaryGreyText},children:["Financial year",(0,P.jsx)(p.Z,{endIcon:(0,P.jsx)(b.Z,{iconName:"ChevronDown",iconProps:{fill:t.palette.common.primaryGreyText}}),onClick:e=>g(e.currentTarget),children:(0,P.jsx)(n.KH,{fontSize:18,sx:{color:t.palette.common.primaryGreyText},children:" ".concat(C)})}),(0,P.jsx)(x.Z,{anchorEl:d,open:Boolean(d),onClose:()=>g(null),children:T.map((e=>(0,P.jsx)(m.Z,{onClick:()=>{R(e),g(null)},children:e},e)))})]})}),("Discount Structure Savings"===e.heading||"GST Return"===e.heading||"Monthly TDS Return"===e.heading||"Customer Disbursement"===e.heading||"Restaurant Incentive"===e.heading||"Monthly Restaurant transaction"===e.heading||"Restaurant Membership Profit"===e.heading)&&(0,P.jsx)(i.Z,{flexDirection:"row",flexWrap:"wrap",gap:1,children:Object.entries(Q).map((e=>e[1].map((t=>(0,P.jsx)(p.Z,{size:"large",variant:E===t?"contained":"outlined",sx:{width:224,height:48},onClick:()=>Y(t),disabled:C===s&&((new Date).getMonth()<Number(f()().month(t).format("M"))||!e[1].map((e=>Number(f()().month(e).format("M")))).includes((new Date).getMonth())),children:(0,P.jsx)(n.KH,{fontSize:18,children:t})},t)))))}),"Quarterly TDS Return"===e.heading&&(0,P.jsx)(i.Z,{flexDirection:"row",flexWrap:"wrap",gap:1,children:[{label:"Apr - Jun",value:Q[1]},{label:"Jul - Sep",value:Q[2]},{label:"Oct - Dec",value:Q[3]},{label:"Jan - Mar",value:Q[4]}].map((e=>(0,P.jsx)(p.Z,{size:"large",variant:E===e.label?"contained":"outlined",sx:{width:224,height:48},onClick:()=>Y(e.label),disabled:C===s&&((new Date).getMonth()+1>4&&"January"===e.value[0]||(new Date).getMonth()<Math.max(...e.value.map((e=>Number(f()().month(e).format("M")))))),children:(0,P.jsx)(n.KH,{fontSize:18,children:e.label})},e.label)))}),"Restaurant Disbursement"===e.heading&&(0,P.jsx)(D._,{dateAdapter:M.Q,children:(0,P.jsx)(k.C,{components:["DatePicker"],sx:{flexDirection:"column-reverse !important",overflow:"hidden",padding:"inherit"},children:(0,P.jsx)(j.w,{views:["day"],onChange:e=>{if(q(e),e){const t=e.date(),a=(e.month()+1).toString();console.log(a),G(t),F(a)}else console.log("Date value is null")},disableFuture:!0,defaultCalendarMonth:f()(new Date(2024,0)),sx:{"& .MuiPickersLayout-actionBar":{display:"none"},"& .MuiPickersToolbar-root":{display:"none"},"& .MuiPickersSlideTransition-root":{height:500},"& .MuiPickersLayout-contentWrapper":{height:500},"& .MuiDateCalendar-root":{width:"100%",height:"100%",display:"contents",paddingBottom:3},"& .MuiDayCalendar-header":{display:"none"},"& .MuiPickersCalendarHeader-root":{display:"visible"},"& .MuiPickersDay-root":{fontSize:"18px",fontWeight:600,fontFamily:"Poppins",gap:"12px",width:48,height:48,borderRadius:"4px",borderWidth:1,borderStyle:"solid",margin:"12px",borderColor:t.palette.primary.main},".Mui-disabled":{borderColor:"#C8C8C8"}}})})}),"Vendor Payment"===e.heading&&(0,P.jsxs)(D._,{dateAdapter:M.Q,children:[(0,P.jsx)(i.Z,{flexDirection:"row",flexWrap:"wrap",gap:1}),(0,P.jsx)(k.C,{components:["DatePicker"],sx:{flexDirection:"column-reverse !important",overflow:"hidden",padding:"inherit"},children:(0,P.jsx)(j.w,{views:["day"],onChange:e=>{if(q(e),e){const t=e.date(),a=(e.month()+1).toString();console.log(a),G(t),F(a)}else console.log("Date value is null")},disableFuture:!0,defaultCalendarMonth:f()(new Date(2024,0)),sx:{"& .MuiPickersLayout-actionBar":{display:"none"},"& .MuiPickersToolbar-root":{display:"none"},"& .MuiPickersSlideTransition-root":{height:500},"& .MuiPickersLayout-contentWrapper":{height:500},"& .MuiDateCalendar-root":{width:"100%",height:"100%",display:"contents",paddingBottom:3},"& .MuiDayCalendar-header":{display:"none"},"& .MuiPickersCalendarHeader-root":{display:"visible"},"& .MuiPickersDay-root":{fontSize:"18px",fontWeight:600,fontFamily:"Poppins",gap:"12px",width:48,height:48,borderRadius:"4px",borderWidth:1,borderStyle:"solid",margin:"12px",borderColor:t.palette.primary.main},".Mui-disabled":{borderColor:"#C8C8C8"}}})})]}),(0,P.jsxs)(i.Z,{flexDirection:"row",gap:2,alignSelf:"self-end",children:[(0,P.jsx)(w.Z,{variant:"outlined",size:"large",sx:{width:166},onClick:e.handleClose,children:(0,P.jsx)(n.KH,{fontSize:18,sx:{color:t.palette.common.primaryGreyText},children:"Cancel"})}),(0,P.jsx)(w.Z,{variant:"contained",size:"large",sx:{width:166},onClick:()=>{let t={url:"",request:{month:f()().month(E).format("M"),year:(new Date).getFullYear()}},n={url:"",request:{quarter:f()().month(E).format("M"),year:(new Date).getFullYear()}},r=1;const[i,l]=C.split("-");console.log(i),console.log(B),console.log(W);const s="".concat(W||1,"-").concat(B,"-").concat(i),d=f()(s,"DD-MM-YYYY");console.log(d.format("DD-MM-YYYY"));switch(e.heading){case"Vendor Payment":t={url:"download_vendor_payment_report",request:{date:d.format("DD-MM-YYYY")}};break;case"Monthly Restaurant transaction":t={url:"download_monthly_rest_transaction_report",request:{month:parseInt(f()().month(E).format("M")),year:parseInt(i)}};break;case"GST Return":t={url:"download_monthly_gst_report",request:{month:parseInt(f()().month(E).format("M")),year:parseInt(i)}};break;case"Quarterly TDS Return":N="Jan - Mar"===E?l:i,"Apr - Jun"===E?r=2:"Jul - Sep"===E?r=3:"Oct - Dec"===E?r=4:"Jan - Mar"===E&&(r=1),n={url:"download_quarterly_tds_report",request:{quarter:r,year:parseInt(N)}};break;case"Monthly TDS Return":t={url:"download_monthly_tds_report",request:{month:parseInt(f()().month(E).format("M")),year:parseInt(i)}};break;case"Restaurant Disbursement":t={url:"download_restaurant_disbursement_report",request:{date:null===z||void 0===z?void 0:z.format("DD-MM-YYYY")}};break;case"Discount Structure Savings":t={url:"download_discount_structure_reports",request:{month:parseInt(f()().month(E).format("M")),year:parseInt(i)}};break;case"Restaurant Membership Profit":t={url:"download_restaurant_membership_report",request:{month:parseInt(f()().month(E).format("M")),year:parseInt(i)}};break;case"Restaurant Incentive":t={url:"download_restaurant_incentive_report",request:{month:parseInt(f()().month(E).format("M")),year:parseInt(i)}};break;case"Customer Disbursement":t=(()=>{const e=parseInt(f()().month(E).format("M"));return{url:"download_customer_disbursement_report",request:{month:e,year:e<=3?parseInt(l):parseInt(i)}}})()}I.mutateAsync("Quarterly TDS Return"===e.heading?n:t).then((e=>{var t;window.open(e.data.download_link),a({title:"Success!",variant:"sucess",content:null===(t=e.data)||void 0===t?void 0:t.message,onCancel:()=>o()})})).catch((e=>{var t,n;a({title:"Error!",variant:"error",content:null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message,onCancel:()=>o()})})),e.handleClose()},children:(0,P.jsx)(n.KH,{fontSize:18,children:"Download"})})]})]})]})}}}]);