"use strict";(self.webpackChunkrich_penny_frontend=self.webpackChunkrich_penny_frontend||[]).push([[287],{3287:(e,t,a)=>{a.r(t),a.d(t,{default:()=>W});var n=a(2757),r=a(331),o=a(4857),l=a(3230),i=a(6491),s=a(2236),d=a(4142),c=a(9950),u=a(57),h=a(4877),x=a(7758),p=a(4710),m=a(2620),v=a(9246),g=a(1920);const b=e=>(0,g.useQuery)(["get_investment_data",e],(()=>(0,v.A)({method:"GET",url:"/get_investment_data/",params:e})));var f=a(8095),w=a(5098),_=a(7239),A=a(1088),j=a(4414);const y=["Daily","Monthly"],C=()=>{var e,t,a,r,i,s;const d=(0,o.A)(),{showSnackbar:u,hideSnackbar:C}=(0,p.dh)(),[k,P]=(0,c.useState)(""),[T,D]=(0,c.useState)("Daily"),[H,G]=(0,c.useState)(null),S=(0,g.useQuery)(["get_transaction_fees"],(()=>(0,v.A)({method:"GET",url:"/get_transaction_fees/1/"}))),M=(0,g.useMutation)((e=>(0,v.A)({method:"Put",url:"/update_transaction_fees/1/",data:e.request}))),E=b({data_type:T.toLowerCase()}),W=null!==(e=null===(t=E.data)||void 0===t?void 0:t.data.data.transaction_data)&&void 0!==e?e:[],L=[{field:"date",renderHeader:()=>"Daily"===T?"Date":"Month",renderCell:e=>{let{row:t}=e;return t.date},tableCellProps:{sx:{width:120}},tableHeaderProps:{sx:{width:120}}},{field:"total_transaction",renderHeader:()=>"Total Transaction (\u20b9)",renderCell:e=>{let{row:t}=e;return t.total_transaction},tableCellProps:{sx:{width:250,textAlign:"center"}},tableHeaderProps:{sx:{width:250,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"total_gst",renderHeader:()=>"Total GST",renderCell:e=>{let{row:t}=e;return t.total_gst},tableCellProps:{sx:{width:200,textAlign:"center"}},tableHeaderProps:{sx:{width:200,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"total_investment",renderHeader:()=>"Total Investment (\u20b9)",renderCell:e=>{let{row:t}=e;return t.total_investment},tableCellProps:{sx:{width:200,textAlign:"center"}},tableHeaderProps:{sx:{width:200,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"total_commission",renderHeader:()=>"Total Comission",renderCell:e=>{let{row:t}=e;return t.total_commission},tableCellProps:{sx:{width:210,textAlign:"center"}},tableHeaderProps:{sx:{width:210,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"gst_commission",renderHeader:()=>"GST on Commision",renderCell:e=>{let{row:t}=e;return t.gst_commission},tableCellProps:{sx:{width:200,textAlign:"center"}},tableHeaderProps:{sx:{width:200,flexDirection:"column",textAlign:"-webkit-center"}}}];return(0,c.useEffect)((()=>{var e,t,a;P(null!==(e=null===(t=S.data)||void 0===t||null===(a=t.data.response_data)||void 0===a?void 0:a.transaction_fees)&&void 0!==e?e:"")}),[S.dataUpdatedAt]),(0,j.jsxs)(l.A,{gap:2,flexGrow:"inherit",children:[(0,j.jsxs)(l.A,{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",children:[(0,j.jsxs)(l.A,{flexDirection:"row",gap:2,alignItems:"flex-end",children:[(0,j.jsx)(x.A,{fieldName:"input",fieldProps:{label:"Transaction Fee",fullWidth:!0,sx:{width:465,gap:0},disabled:null===(a=S.data)||void 0===a||null===(r=a.data.response_data)||void 0===r?void 0:r.clickable},onChange:(e,t)=>P(t),value:k}),(0,j.jsx)(f.A,{variant:"contained",size:"large",sx:{height:40},loading:M.isLoading,disabled:null===(i=S.data)||void 0===i||null===(s=i.data.response_data)||void 0===s?void 0:s.clickable,children:(0,j.jsx)(n.j3,{variant:"caption",onClick:()=>{M.mutateAsync({request:{transaction_fee:k}}).then((e=>{var t;u({title:"Success!",variant:"sucess",content:null===(t=e.data)||void 0===t?void 0:t.message,onCancel:()=>C()}),E.refetch(),S.refetch()})).catch((e=>{var t,a;u({title:"Error!",variant:"error",content:null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message,onCancel:()=>C()})}))},children:"Submit"})})]}),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(w.A,{variant:"outlined",size:"large",sx:{minWidth:180,borderColor:"#DFE3ED",justifyContent:"space-between"},onClick:e=>G(e.currentTarget),endIcon:(0,j.jsx)(h.A,{iconName:"ChevronDown",iconProps:{fill:d.palette.common.primaryGreyText}}),children:(0,j.jsx)(n.j3,{variant:"subtitle2",sx:{color:d.palette.common.primaryGreyText},children:T})}),(0,j.jsx)(_.A,{anchorEl:H,open:Boolean(H),onClose:()=>G(null),sx:{".MuiMenu-paper":{left:"auto !important",right:`${d.spacing(3)} !important`,width:null===H||void 0===H?void 0:H.offsetWidth}},children:y.map((e=>(0,j.jsx)(A.A,{onClick:()=>{D(e),G(null)},children:e},e)))})]})]}),(0,j.jsx)(m.A,{rows:W,columns:L,rowId:e=>e.id,tableProps:{size:"small",stickyHeader:!1},tableRowProps:{hover:!0},loading:E.isLoading,sx:{paddingTop:5}})]})},k=(0,c.memo)(C);var P=a(934),T=a(3308),D=a(9051),H=a.n(D);const G=()=>{var e,t,a,r;const s=(0,o.A)(),{showAlertDialog:d,hideAlertDialog:u}=(0,P.Ue)(),{showSnackbar:b,hideSnackbar:f}=(0,p.dh)(),_=(0,g.useQuery)(["get_profit_for_month/3/"],(()=>(0,v.A)({method:"GET",url:"/get_profit_for_month/3/"}))),A=(0,g.useMutation)((e=>(0,v.A)({method:"POST",url:"/add_profit_for_month/",data:e.request}))),y=(0,g.useQuery)(["get_monthly_payback_data"],(()=>(0,v.A)({method:"GET",url:"/get_monthly_payback_data/"}))),[C,k]=(0,c.useState)(""),D=new Date((new Date).setMonth((new Date).getMonth()-1)),G=H()(D.toDateString()).format("MMMM");console.warn(G);const S=null!==(e=null===(t=y.data)||void 0===t?void 0:t.data.data.payback_data)&&void 0!==e?e:[],M=[{field:"month_year",renderHeader:()=>"Month",renderCell:e=>{let{row:t}=e;return t.month_year},tableCellProps:{sx:{width:200}},tableCellTypographySx:{paddingLeft:s.spacing(1)},tableHeaderProps:{sx:{width:200}}},{field:"total_disbursable_amount",renderHeader:()=>"Total Disbursable Amount (\u20b9)",renderCell:e=>{let{row:t}=e;return t.total_disbursable_amount},tableCellProps:{sx:{width:350,textAlign:"center"}},tableHeaderProps:{sx:{width:350,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"payback_to_user",renderHeader:()=>"Payback Disbursed to User",renderCell:e=>{let{row:t}=e;return t.payback_to_user},tableCellProps:{sx:{width:350,textAlign:"center"}},tableHeaderProps:{sx:{width:350,flexDirection:"column",textAlign:"-webkit-center"}}},{field:"payback_to_restaurant",renderHeader:()=>"Payback Disbursed to Restaurant (\u20b9)",renderCell:e=>{let{row:t}=e;return t.payback_to_restaurant},tableCellProps:{sx:{width:400,textAlign:"center"}},tableHeaderProps:{sx:{width:400,flexDirection:"column",textAlign:"-webkit-center"}}}];return(0,c.useEffect)((()=>{var e,t,a;k(null!==(e=null===(t=_.data)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.profit_for_month)&&void 0!==e?e:"")}),[_.dataUpdatedAt]),(0,j.jsxs)(l.A,{gap:2,flexGrow:"inherit",children:[(0,j.jsxs)(l.A,{flexDirection:"row",gap:2,alignItems:"flex-end",children:[(0,j.jsx)(x.A,{fieldName:"input",fieldProps:{label:"Profit for Month",fullWidth:!0,sx:{width:465,gap:0},disabled:null===(a=_.data)||void 0===a?void 0:a.data.clickable},onChange:(e,t)=>k(t),value:C}),(0,j.jsx)(w.A,{variant:"contained",size:"large",sx:{height:40},onClick:()=>{d({title:(0,j.jsxs)(l.A,{flexDirection:"row",gap:3,children:[(0,j.jsx)(h.A,{iconName:"Warning",iconProps:{style:{marginTop:"8px"}}}),(0,j.jsxs)(l.A,{children:[(0,j.jsx)(n.j3,{variant:"h4",sx:{color:s.palette.common.primaryGreyText},children:"Profit Amount Confirmation"}),(0,j.jsx)(n.j3,{variant:"subtitle1",sx:{color:"#929292"},children:"Your are entering the the profit amount. Make sure you have entered correct amount."})]})]}),content:(0,j.jsx)(i.A,{gap:2,sx:{textAlign:"-webkit-center","& table":{borderCollapse:"separate",borderSpacing:"0 4px"},"& .tdValue":{paddingLeft:4},"& tr":{verticalAlign:"top"}},children:(0,j.jsx)(T.A,{data:[{name:(0,j.jsxs)(l.A,{flexDirection:"row",justifyContent:"space-between",children:[(0,j.jsx)(n.j3,{variant:"h6",paddingRight:4,sx:{color:s.palette.common.primaryGreyText},fontWeight:400,children:"Profit Amount (\u20b9)"}),(0,j.jsx)(n.j3,{variant:"subtitle1",sx:{color:s.palette.common.secondaryGreyText},children:":"})]}),value:(0,j.jsx)(n.j3,{variant:"h6",paddingRight:4,sx:{color:s.palette.common.primaryGreyText},fontWeight:600,children:C}),showWhen:!0},{name:(0,j.jsxs)(l.A,{flexDirection:"row",justifyContent:"space-between",gap:2,children:[(0,j.jsx)(n.j3,{variant:"h6",sx:{color:s.palette.common.primaryGreyText},fontWeight:400,children:G}),(0,j.jsx)(n.j3,{variant:"subtitle1",sx:{color:s.palette.common.secondaryGreyText},children:":"})]}),value:(0,j.jsx)(n.j3,{variant:"h6",sx:{color:s.palette.common.primaryGreyText},fontWeight:600}),showWhen:!0}]})}),buttons:[{children:"Cancel",variant:"outlined",callback:()=>{u()}},{children:"Confirm",variant:"contained",callback:()=>{A.mutateAsync({request:{profit_for_month:C}}).then((e=>{var t;b({title:"Success!",variant:"sucess",content:null===(t=e.data)||void 0===t?void 0:t.message,onCancel:()=>f()}),u(),_.refetch(),y.refetch()})).catch((e=>{var t,a;b({title:"Error!",variant:"error",content:null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message,onCancel:()=>f()})}))}}]})},disabled:null===(r=_.data)||void 0===r?void 0:r.data.clickable,children:(0,j.jsx)(n.j3,{variant:"caption",children:"Submit"})})]}),(0,j.jsx)(m.A,{rows:S,columns:M,rowId:e=>e.id,tableProps:{size:"small",stickyHeader:!1},tableRowProps:{hover:!0},loading:y.isLoading,sx:{paddingTop:5}})]})},S=(0,c.memo)(G),M=["INVESTMENT","PAYBACK"],E=()=>{var e,t,a,h;const x=(0,o.A)();(0,r.o)(r.L.investment);const p=b(),[m,v]=(0,c.useState)(0);return(0,j.jsxs)(l.A,{gap:2,flexGrow:"inherit",children:[(0,j.jsxs)(l.A,{gap:2,flexDirection:"row",children:[(0,j.jsx)(u.Lc,{heading:"Total Investment",content:null===(e=p.data)||void 0===e?void 0:e.data.data.total_investment}),(0,j.jsx)(u.Lc,{heading:"Total Payback Amount",content:null===(t=p.data)||void 0===t?void 0:t.data.data.total_payback_amount,sx:{width:250}}),(0,j.jsx)(u.Lc,{heading:"Current Payback",content:null===(a=p.data)||void 0===a?void 0:a.data.data.current_payback}),(0,j.jsx)(u.Lc,{heading:"Current Investment",content:null===(h=p.data)||void 0===h?void 0:h.data.data.current_investment})]}),(0,j.jsxs)(l.A,{gap:2,flexGrow:1,children:[(0,j.jsx)(i.A,{sx:{width:"100%",padding:"8px",backgroundColor:"#E9EBF0",borderRadius:"8px"},children:(0,j.jsx)(s.A,{value:m,onChange:(e,t)=>{v(t)},children:M.map(((e,t)=>(0,j.jsx)(d.A,{sx:{minWidth:"50%"},label:(0,j.jsx)(n.j3,{variant:"subtitle1",sx:{color:x.palette.common.primaryGreyText},children:e})},t)))})}),0===m&&(0,j.jsx)(k,{}),1===m&&(0,j.jsx)(S,{})]})]})},W=(0,c.memo)(E)}}]);